name: Reusable Datadog Service Definition
on: 
  workflow_call:
    inputs:
      serviceName:
        required: true
        type: string
      emailName:
        required: true
        type: string
      squadName:
        required: true
        type: string
      slackChannelName:
        required: true
        type: string
      # tagsName:
      #   required: true
      #   type: string
      reposName:
        required: true
        type: string
      reposURL:
        required: true
        type: string
      reposProvider:
        required: true
        type: string
      # reposMatrix:
      #   required: true
      #   type: string
jobs:
  datadog-service-deinition:
    runs-on: ubuntu-latest
    steps:
      - name: Get Code
        uses: actions/checkout@v3
        # with:
        #   repository: bruno561/opentelemetry-demo
        #   ref: 'dev'
      - name: Service Definition
        uses: arcxp/datadog-service-catalog-metadata-provider@v1.0.4
        with:
          datadog-hostname: api.us5.datadoghq.com
          datadog-key: ${{ secrets.DATADOG_API_KEY }}
          datadog-app-key: ${{ secrets.DATADOG_APPLICATION_KEY }}
          service-name: ${{ inputs.serviceName }}
          team: ${{ inputs.squadName }}
          email: ${{ inputs.emailName }}
          slack-support-channel: ${{ inputs.slackChannelName }}
          contacts: |
            - name: name
              type: email
              value: test@gmail.com
          docs: |
            - name: name
              url: http://google.com
              provider: GitHub
          links: |
            - name: name1
              url: http://google.com
              type: doc1
          repos: |
            - name: ${{ inputs.reposName }}
              url: ${{ inputs.reposURL }}
              provider: ${{ inputs.reposProvider }}
            - name: ${{ inputs.reposName }}
              url: ${{ inputs.reposURL }}
              provider: ${{ inputs.reposProvider }}
          # tags: ${{ inputs.tagsName }}